@using DeerskinSimulation.Resources
@using DeerskinSimulation.ViewModels
@using DeerskinSimulation.Models
@using DeerskinSimulation.Components
@inject IJSRuntime JS

@code {
    [Parameter] public List<NotificationEventArgs> Messages { get; set; }

    protected override void OnParametersSet()
    {
        // Scroll to bottom when messages are updated
        if (Messages?.Count > 0)
        {
            InvokeAsync(ScrollToBottomAsync);
        }
    }

    private async Task ScrollToBottomAsync()
    {
        await Task.Delay(100); // Give time for the UI to update
        await JS.InvokeVoidAsync("scrollToBottom", "console");
    }
}

<div id="console" style="height: 200px; overflow-y: scroll; border: 1px solid #8b4513; padding: 10px;">
    @if (Messages?.Any() == true)
    {
        @foreach (var e in Messages)
        {
            @foreach (var m in e.Records)
            {
                <MessageConsoleLineItem Message="m" />
            }
        }
    }
    else
    {
        <p>@UIStr.NoMessagesLabel</p>
    }
</div>

<script>
    window.scrollToBottom = function (elementId) {
        var element = document.getElementById(elementId);
        if (element) {
            element.scrollTop = element.scrollHeight;
        }
    };
</script>
